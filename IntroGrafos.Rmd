---
title: "Notebook Grafos Aula 01"
output: github_document
---

```{r setup, include=TRUE}
knitr::opts_chunk$set(echo = TRUE)

## Notebook Grafos Aula 01

### Bibliotecas
library(dplyr)
library(plyr)
library(igraph)
library(timeordered)

### Consciência situacional
setwd('/Users/sidneibarbieri/Documents/Grafos/IntroGrafos/')
getwd()
g1 = read_graph("./G1.net", format = c("pajek"))
g1

g2 <- graph( edges = c(1,2, 
                       1,3, 
                       2,3, 
                       3,4, 
                       4,5), n=5, directed=F)
plot(g2)
plot(g2, vertex.size=40, vertex.color="orange", edge.color="darkblue", edge.width=2, vertex.label.font=5)


### Plotar o Grafo G1
plot(g1)
plot(g1, vertex.size=40, vertex.color="orange", edge.color="darkblue", edge.width=2, vertex.label.font=5)

names = V(g1)$id
names

plot(g1, vertex.label=names, 
     vertex.size=40, 
     vertex.color="yellow", 
     edge.color="darkblue", 
     edge.width=2, 
     vertex.label.font=5)

### Listar Vértices
V(g1)
V(g2)

###Nomes dos Vérices
V(g1)$name
vertex_attr(g1)

V(g2)$name
V(g2)$name <- c("1", "2", "3", "4", "5")
vertex_attr(g2)


### Listar Arestas
E(g1)

#### Peso das Arestas
E(g1)$weight

edge_attr(g2)
E(g2)$weight <- 1
edge_attr(g2)


### Matriz de Incidências
g1[]


### Conexões de um Vértice
#### Vértice 1
g1[1,]

#### Vértice 5
g1[5,]


### Distribuição de Graus
d1 = degree.distribution(g1, cumulative=FALSE)
len = length(d1)

png(filename="G1_graus.png", height=500, width=500, bg="white")
barplot(d1, main="Distribuição de Graus", xlab="Graus", ylab="PDF", names.arg=c(0:(len-1)))

dev.off()

### Proximidade dos Vértices
cl = closeness(g1)
cl


### Vértice com maior grau
cl_max= max(cl)
cl_max

vindex_max = which(closeness(g1) == cl_max)
vindex_max

vmax=V(g1)[vindex_max]$id
vmax


### Vértice com menor grau
cl_min= min(cl)
cl_min

vindex_min = which(closeness(g1) == cl_min)
vindex_min

vmin=V(g1)[vindex_min]$id
vmin


### Máxima distância mínima entre Vértices
b = betweenness(g1)
bmax=max(b)
bmax

bindex_max = which(betweenness(g1) == bmax)
bindex_max

bmax=V(g1)[bindex_max]$id
bmax

bmin= min(b)
bmin

bindex_min = which(betweenness(g1) == bmin)
bindex_min

bmin=V(g1)[bindex_min]$id
bmin


### Arestas
vcount(g1)
ecount(g1)
E(g1)
eb = edge.betweenness(g1)
eb


### Caminho mais curto
distances(g1)

coreness(g1, mode="all")

g2 <- simplify(g2, remove.multiple = F, remove.loops = T)


### Lista de Arestas
as_edgelist(g2, names=T)


### Matriz de Adjacências 
madj <- as_adjacency_matrix(g2, attr="weight")


### Matriz de Caminhos Mínimos
distances(g1)


### Grau dos Vértices
degree(g2)
grau <- degree(g2)
as.data.frame(grau)

V(g2)$grau <- 0
gr1 <- sum(madj[,1])
gr2 <- sum(madj[,2])
gr3 <- sum(madj[,3])
gr4 <- sum(madj[,4])
gr5 <- sum(madj[,5])

V(g2)$grau <- c(gr1, gr2, gr3, gr4, gr5)
V(g2)$grau


### Coeficiente de aglomeração
V(g2)$coef <- c(0, 0, 0, 0, 0)
V(g2)$coef <- as.double(V(g2)$coef)

c1 = 2*1/gr1*(gr1-1)
c2 = 2*1/gr2*(gr2-1)
c3 = 2*1/gr3*(gr3-1)
c4 = 2*0/gr4*(gr4-1)
c5 = 2*0/gr5*(gr5-1)

V(g2)$coef <- as.double(c(c1, c2, c3, c4, c5))

V(g2)$coef

### Mínimo caminho médio
mcm <- distances(g1)
mcm <- as.data.frame(mcm)

l1 <- sum(mcm[1,])/(5-1)
l2 <- sum(mcm[2,])/(5-1)
l3 <- sum(mcm[3,])/(5-1)
l4 <- sum(mcm[4,])/(5-1)
l5 <- sum(mcm[5,])/(5-1)

average.path.length(g2, directed = FALSE)


### Diâmetro
diameter(g2)


```

