{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Notebook do Projeto de Data Science\"\noutput: github_document\n---\n\n```{r setup, include=TRUE}\nknitr::opts_chunk$set(echo = TRUE)\n\n\n### Avaliação dos Dados Fornecidos pelo CertBR\n\n\n### Bibliotecas\nlibrary(readr)\nlibrary(dplyr)\nlibrary(stringr)\nlibrary(tidyr)\nlibrary(ggplot2)\n\n\n### Suprimindo mensagens de warning \nsearchpaths()\nsuppressMessages(library(dplyr))\n\n\n### Consciência situacional\norig <- getwd()\norig\nsetwd(orig)\n\nfile.exists(\"./CertBR.csv\")\nfile <- \"./CertBR.csv\"\n\ntamanho <- file.info(file)$size\ntamanho\n\n\n### Importando o arquivo (https://www.cert.br/stats/incidentes/)\ndf <- read.csv2(file, header = TRUE, sep =\";\", dec=\",\", stringsAsFactors = FALSE, encoding = \"UTF-8\")\ndf <- as.data.frame(df)\n\n\n### Entendendo o dataframe\nhead(df)\nclass(df)\nstr(df)\nsummary(df)\nsample_n(df, size = 5)\n\n\n### Conversões das colunas\ndf$Total <- as.integer(df$Total)\ndf$Worm <- as.integer(df$Worm)\ndf$Worm_P <- as.double(df$Worm_P)\ndf$DOS <- as.integer(df$DOS)\ndf$DOS_P <- as.double(df$DOS_P)\ndf$Invasao <- as.integer(df$Invasao)\ndf$Invasao_P <- as.double(df$Invasao_P)\ndf$Web <- as.integer(df$Web)\ndf$Web_P <- as.double(df$Web_P)\ndf$Scan <- as.integer(df$Scan)\ndf$Scan_P <- as.double(df$Scan_P)\ndf$Fraude <- as.integer(df$Fraude)\ndf$Fraude_P <- as.double(df$Fraude_P)\n\n\n### Remover NAs (Subsituir por zero)\ndf[is.na(df)] <- 0 \nsample_n(df, size = 10)\n\n\n### Verificar se o Total corresponde à soma das demais colunas\ndf$Total -  (df$Worm + df$DOS + df$Invasao + df$Web + df$Scan + df$Fraude)\n\n\n### Acrescentar e validar a coluna \"Outros\"\ndf$Outros <- df$Total - (df$Worm + df$DOS + df$Invasao + df$Web + df$Scan + df$Fraude)\ndf$Total -  (df$Worm + df$DOS + df$Invasao + df$Web + df$Scan + df$Fraude + df$Outros)\n\n\n### Acresdentar coluna com valores percentuais para \"Outros\"\ndf$Outros_P <- as.double(sprintf(\"%0.2f\", (df$Outros / df$Total)))\n\ndf$Outros <- as.integer(df$Outros)\ndf$Outros_P <- as.double(sprintf(\"%0.2f\", (df$Outros_P)))\n\n\n### Overview: identificar se há problemas no arredondamento dos valores (se a soma de percentuais é 100)\nglimpse(df)\nglimpse(mutate(df, Soma100 = Worm_P + DOS_P + Invasao_P + Web_P + Scan_P + Fraude_P + Outros_P))\nglimpse(mutate(df, Soma = Worm + DOS + Invasao + Web + Scan + Fraude + Outros))\n\n\n### Corrigindo os arredondamentos e a representação (duas casas decimais):\ndf$Worm_P <- as.double(sprintf(\"%0.2f\", (df$Worm / df$Total)))\ndf$DOS_P <- as.double(sprintf(\"%0.2f\", (df$DOS / df$Total)))\ndf$Invasao_P <- as.double(sprintf(\"%0.2f\", (df$Invasao / df$Total)))\ndf$Web_P <- as.double(sprintf(\"%0.2f\", (df$Web / df$Total)))\ndf$Scan_P <- as.double(sprintf(\"%0.2f\", (df$Scan / df$Total)))\ndf$Fraude_P <- as.double(sprintf(\"%0.2f\", (df$Fraude / df$Total)))\ndf$Outros_P <- as.double(sprintf(\"%0.2f\", (df$Outros / df$Total)))\n\n\n### Validar a soma de valores percentuais\nglimpse(mutate(df, Soma100 = Worm_P + DOS_P + Invasao_P + Web_P + Scan_P + Fraude_P + Outros_P))\n\n### Overview\nsample_n(df, size = 5)\n\n\n### Seleção de partes\ndfData <- select(df, Ano, Mes, Total)\nhead(dfData)\nclass(dfData)\ndfSelect <- select(df, Ano:Total)\nsample_n(dfSelect, size = 5)\n\n\n### Verificar se constam as informações de todos os 12 meses\ncount(df, Ano)\nhist(df$Total)\n\n\n### Filtrar valores significativos\nfilter(df, Total > 100000)\nfilter(df, Total > 50000, Fraude > 100000)\nfilter(df, Total > 50000, Fraude > 100000, Mes %in% c(\"ago\", \"set\"), Ano %in% c(\"2014\"))\n\n\n### Identificando padrões com arrange () \ntbl_df(df) %>% arrange(Ano) %>% head\n\ntbl_df(df)  %>% arrange(Mes)\n\ntbl_df(df)  %>% select(Mes, Ano, Total)  %>% arrange(Mes)\n\ntbl_df(df)  %>% select(Mes, Ano, Total)  %>% arrange(Mes) %>% filter(Total > median(Total, na.rm = TRUE))\n\ntbl_df(df)  %>% select(Mes, Ano, Total)  %>% arrange(Mes) %>% filter(Ano >= 2011)\n\ntbl_df(df)  %>% select(Mes, Ano, Total)  %>% arrange(Mes, desc(Mes)) %>% filter(Ano >= 2011)\n\nhead(df)\n\n\n### Melhorar a exibição\noptions(digits = 3)\nhead(df)\n\n\n### Informações sobre os valores da coluna Total\ndf  %>% summarise(AvgTotal = mean(Total),\n                  MinTotal = min(Total),\n                  MaxTotal = max(Total),\n                  total = n())\n\n\n### Análise de Grupos (Ano)\ndf  %>% \n  group_by(Ano) %>%\n  summarise(AvgTotal = mean(Total),\n            MinTotal = min(Total),\n            MaxTotal = max(Total),\n            total = n())\n\n\n### Análise de Grupos (Mês)\ndf  %>% \n  group_by(Mes) %>%\n  summarise(AvgTotal = mean(Total),\n            MinTotal = min(Total),\n            MaxTotal = max(Total),\n            total = n())\n\n\n### Análises Diversas (Ataques de DOS acima da média)\ndf  %>% \n  select(Mes, Ano, DOS)   %>% \n  filter(DOS > mean(DOS))  %>%\n  head\n\n\n### Remodelagem dos dados com TidyR\ndf$Mes <- c(01, 02, 03, 04, 05, 06, 07, 08, 09, 10, 11, 12)\n\n\n### Corrigindo sequência cronológica\ndf <- df  %>% select(Mes, Ano, Worm, Worm_P, DOS, DOS_P, Invasao, Invasao_P, Web, Web_P, Scan, Scan_P, Fraude, Fraude_P, Outros, Outros_P, Total)  %>% arrange(Mes, desc(Mes)) %>% arrange(Ano, desc(Ano))\n\n\n### Analisando a relação entre Invasão e Scan\ndfRelation <- df[(df$Invasao > median(df$Invasao)) & (df$Scan > median(df$Scan)), ]\ndfRelation <- tbl_df(dfRelation)\nsample_n(dfRelation, size = 12)\n\n\n### Secção do dataframe \ndfC <- subset(df, select = c(Mes, Ano, Worm, Worm_P, DOS, DOS_P, Invasao, Invasao_P, Web, Web_P, Scan, Scan_P, Fraude, Fraude_P, Outros, Outros_P, Total))\ndfN <- subset(df, select = c(Mes, Ano, Worm, DOS, Invasao, Web, Scan, Fraude, Outros))\ndfP <- subset(df, select = c(Mes, Ano, Worm_P, DOS_P, Invasao_P, Web_P, Scan_P, Fraude_P, Outros_P))\n\n### Dataframe Completo, Percentual, Valores Absolutos: tbl_df (melhorar a apresentação)\ndfC <- tbl_df(dfC)\ndfN <- tbl_df(dfN)\ndfP <- tbl_df(dfP)\n\nclass(dfC)\nhead(dfC)\n\n\n### Reduzindo a Complexidade com um DF sobre Invasões\ndfinv <- dfC  %>% select(Ano, DOS, Invasao, Web)  %>% filter(Ano == 2016)\ndfinv <- dfC  %>% select(Ano, DOS, Invasao, Web)\nclass(dfinv)\nstr(dfinv)\ndfinv$DOS <- as.integer(dfinv$DOS)\nstr(dfinv)\n\nas.tbl(dfinv)\n\n\n# Linegraph do Total Geral de Ataques por Ano\nggplot(dfC, aes(x = Ano, y = Total, group = Ano, colour=Total)) +\n  geom_line(aes(group = 1)) +\n  geom_point() +\n  labs(x = \"Ano\", y = \"Número Total de Ataques\", title = \"Total de Ataques Registrados pelo CertBR\")\n\n\n# Linegraph do Total Geral de Ataques com WORM por Ano\nggplot(dfC, aes(x = Ano, y = Worm, group = Ano, colour=Worm)) +\n  geom_line(aes(group = 1)) +\n  geom_point() +\n  labs(x = \"Ano\", y = \"Número de Ataques com Worm\", title = \"Total de Ataques com Worm Registrados pelo CertBR\")\n\n\n# Linegraph do Total Geral de Ataques de DOS por Ano\nggplot(dfC, aes(x = Ano, y = DOS, group = Ano, colour=DOS)) +\n  geom_line(aes(group = 1)) +\n  geom_point() +\n  labs(x = \"Ano\", y = \"Número de Ataques de DOS\", title = \"Total de Ataques de DOS Registrados pelo CertBR\")\n\n\n# Linegraph do Total Geral de Ataques de Invasao por Ano\nggplot(dfC, aes(x = Ano, y = Invasao, group = Ano, colour=Invasao)) +\n  geom_line(aes(group = 1)) +\n  geom_point() +\n  labs(x = \"Ano\", y = \"Número de Ataques de Invasao\", title = \"Total de Ataques de Invasao Registrados pelo CertBR\")\n\n\n# Linegraph do Total Geral de Ataques a Servidores Web por Ano\nggplot(dfC, aes(x = Ano, y = Web, group = Ano, colour=Web)) +\n  geom_line(aes(group = 1)) +\n  geom_point() +\n  labs(x = \"Ano\", y = \"Número de Ataques a Servidores Web\", title = \"Total de Ataques a Servidores Web Registrados pelo CertBR\")\n\n\n# Linegraph do Total Geral de Scan por Ano\nggplot(dfC, aes(x = Ano, y = Scan, group = Ano, colour=Scan)) +\n  geom_line(aes(group = 1)) +\n  geom_point() +\n  labs(x = \"Ano\", y = \"Número de Scan\", title = \"Total de Scans Registrados pelo CertBR\")\n\n\n# Linegraph do Total Fraudes por Ano\nggplot(dfC, aes(x = Ano, y = Fraude, group = Ano, colour=Fraude)) +\n  geom_line(aes(group = 1)) +\n  geom_point() +\n  labs(x = \"Ano\", y = \"Número de Fraudes\", title = \"Total de Fraudes Registrados pelo CertBR\")\n\n\n# Linegraph do Total de Outros Atques por Ano\nggplot(dfC, aes(x = Ano, y = Outros, group = Ano, colour=Outros)) +\n  geom_line(aes(group = 1)) +\n  geom_point() +\n  labs(x = \"Ano\", y = \"Número de Outros\", title = \"Total de Outros Ataques Registrados pelo CertBR\")\n\n\n# Linegraph dos Percentuais por Modalidaed de Ataques\nggplot(dfP, aes(x = Ano, y , group = Mes, colour = Modalidades)) + \n  geom_line(aes(y = Worm_P, colour = \"Worm\")) + \n  geom_line(aes(y = DOS_P, colour = \"DOS\")) +\n  geom_line(aes(y = Invasao_P, colour = \"Invasão\")) +\n  geom_line(aes(y = Web_P, colour = \"Web\")) +\n  geom_line(aes(y = Fraude_P, colour = \"Fraude\")) +\n  geom_line(aes(y = Outros_P, colour = \"Outros\")) +\n  labs(x = \"Ano\", y = \"Número de Ataques (%)\", title = \"Percentuais por Modalidaed de Ataques Registrados pelo CertBR\")\n\n\n# Linegraph dos Percentuais por Modalidaed de Ataques em 2012\n# (Conferência das Nações Unidas sobre Desenvolvimento Natural - Rio+20, de 13 e 22 de junho de 2012)\ndfP2012 <- tbl_df(dfP)  %>% arrange(Mes) %>% filter(Ano == 2012)\ndfP2012$Mes <- as.factor(dfP2012$Mes)\nggplot(dfP2012, aes(x = Mes, y , group = 1, colour = Modalidades)) + \n  geom_line(aes(y = Worm_P, colour = \"Worm\")) + \n  geom_line(aes(y = DOS_P, colour = \"DOS\")) +\n  geom_line(aes(y = Invasao_P, colour = \"Invasão\")) +\n  geom_line(aes(y = Web_P, colour = \"Web\")) +\n  geom_line(aes(y = Fraude_P, colour = \"Fraude\")) +\n  geom_line(aes(y = Outros_P, colour = \"Outros\")) +\n  labs(x = \"Mês\", y = \"Número de Ataques (%)\", title = \"Percentuais por Modalidaed de Ataques Registrados pelo CertBR em 2012\")\n\n\n# Linegraph dos Percentuais por Modalidaed de Ataques em 2013\n# (XXVIII Jornada Mundial da Juventude aconteceu de 23 a 28 de julho de 2013)\n# (Copa das Confederações de Futebol de 15 a 30 de junho de 2013)\ndfP2013 <- tbl_df(dfP)  %>% arrange(Mes) %>% filter(Ano == 2013)\ndfP2013$Mes <- as.factor(dfP2013$Mes)\nggplot(dfP2013, aes(x = Mes, y , group = 1, colour = Modalidades)) + \n  geom_line(aes(y = Worm_P, colour = \"Worm\")) + \n  geom_line(aes(y = DOS_P, colour = \"DOS\")) +\n  geom_line(aes(y = Invasao_P, colour = \"Invasão\")) +\n  geom_line(aes(y = Web_P, colour = \"Web\")) +\n  geom_line(aes(y = Fraude_P, colour = \"Fraude\")) +\n  geom_line(aes(y = Outros_P, colour = \"Outros\")) +\n  labs(x = \"Mês\", y = \"Número de Ataques (%)\", title = \"Percentuais por Modalidaed de Ataques Registrados pelo CertBR em 2013\")\n\n\n# Linegraph dos Percentuais por Modalidaed de Ataques em 2014\n# (Copa do Mundo, de 12 de junho a 13 de julho de 2014)\ndfP2014 <- tbl_df(dfP)  %>% arrange(Mes) %>% filter(Ano == 2014)\ndfP2014$Mes <- as.factor(dfP2014$Mes)\nggplot(dfP2014, aes(x = Mes, y , group = 1, colour = Modalidades)) + \n  geom_line(aes(y = Worm_P, colour = \"Worm\")) + \n  geom_line(aes(y = DOS_P, colour = \"DOS\")) +\n  geom_line(aes(y = Invasao_P, colour = \"Invasão\")) +\n  geom_line(aes(y = Web_P, colour = \"Web\")) +\n  geom_line(aes(y = Fraude_P, colour = \"Fraude\")) +\n  geom_line(aes(y = Outros_P, colour = \"Outros\")) +\n  labs(x = \"Mês\", y = \"Número de Ataques (%)\", title = \"Percentuais por Modalidaed de Ataques Registrados pelo CertBR em 2014\")\n\n\n# Linegraph dos Percentuais por Modalidaed de Ataques em 2015\ndfP2015 <- tbl_df(dfP)  %>% arrange(Mes) %>% filter(Ano == 2015)\ndfP2015$Mes <- as.factor(dfP2015$Mes)\nggplot(dfP2015, aes(x = Mes, y , group = 1, colour = Modalidades)) + \n  geom_line(aes(y = Worm_P, colour = \"Worm\")) + \n  geom_line(aes(y = DOS_P, colour = \"DOS\")) +\n  geom_line(aes(y = Invasao_P, colour = \"Invasão\")) +\n  geom_line(aes(y = Web_P, colour = \"Web\")) +\n  geom_line(aes(y = Fraude_P, colour = \"Fraude\")) +\n  geom_line(aes(y = Outros_P, colour = \"Outros\")) +\n  labs(x = \"Mês\", y = \"Número de Ataques (%)\", title = \"Percentuais por Modalidaed de Ataques Registrados pelo CertBR em 2015\")\n\n\n# Linegraph dos Percentuais por Modalidaed de Ataques em 2016\n# (Jogos Olímpicos Rio 2016, de 5 a 21 de agosto)\n# (Paralimpíadas Rio 2016, de 7 a 18 de setembro)\ndfP2016 <- tbl_df(dfP)  %>% arrange(Mes) %>% filter(Ano == 2016)\ndfP2016$Mes <- as.factor(dfP2016$Mes)\nggplot(dfP2016, aes(x = Mes, y , group = 1, colour = Modalidades)) + \n  geom_line(aes(y = Worm_P, colour = \"Worm\")) + \n  geom_line(aes(y = DOS_P, colour = \"DOS\")) +\n  geom_line(aes(y = Invasao_P, colour = \"Invasão\")) +\n  geom_line(aes(y = Web_P, colour = \"Web\")) +\n  geom_line(aes(y = Fraude_P, colour = \"Fraude\")) +\n  geom_line(aes(y = Outros_P, colour = \"Outros\")) +\n  labs(x = \"Mês\", y = \"Número de Ataques (%)\", title = \"Percentuais por Modalidaed de Ataques Registrados pelo CertBR em 2016\")\n\n\n\n\n\n\n\n```\n",
    "created" : 1508720572468.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2237832386",
    "id" : "B9093BE",
    "lastKnownWriteTime" : 1506019581,
    "last_content_update" : 1506019581,
    "path" : "~/Documents/CAP386_Sidnei/Projeto/CertBR.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}